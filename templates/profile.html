{% extends 'base.html' %}
{% block title %}@{{ profile_user.username }} — Threadify{% endblock %}

{% block content %}
<div class="row justify-content-center">
  <div class="col-lg-8">

    <div class="card border-0 shadow-sm">
      <div class="card-body">
        <div class="d-flex align-items-start justify-content-between gap-3">
          <div class="d-flex align-items-start gap-3">
            <div class="avatar-lg">
              {% if profile_user.profile.avatar %}
                <img src="{{ profile_user.profile.avatar.url }}" alt="avatar" class="rounded-circle w-100 h-100 object-fit-cover">
              {% else %}
                <div class="avatar-fallback rounded-circle d-flex align-items-center justify-content-center">
                  <i class="bi bi-person fs-3"></i>
                </div>
              {% endif %}
            </div>

            <div>
              <div class="h5 fw-bold mb-0">{{ profile_user.profile.display_name|default:profile_user.username }}</div>
              <div class="text-secondary">@{{ profile_user.username }}</div>
              {% if profile_user.profile.bio %}
                <div class="mt-2">{{ profile_user.profile.bio }}</div>
              {% endif %}

              <div class="d-flex gap-3 mt-2 text-secondary small">
                <div><b id="followersCount">{{ profile_user.profile.followers_count }}</b> متابع</div>
                <div><b>{{ profile_user.profile.following_count }}</b> يتابع</div>
              </div>
            </div>
          </div>

          <div class="d-flex flex-column gap-2">
            {% if user.username == profile_user.username %}
              <a class="btn btn-outline-secondary btn-sm" href="{% url 'edit_profile' %}"><i class="bi bi-pencil"></i> تعديل</a>
            {% else %}
              <button class="btn btn-primary btn-sm js-follow"
                      data-username="{{ profile_user.username }}"
                      data-following="{{ is_following|yesno:'1,0' }}">
                {% if is_following %}
                  <i class="bi bi-person-dash"></i> إلغاء متابعة
                {% else %}
                  <i class="bi bi-person-plus"></i> متابعة
                {% endif %}
              </button>
            {% endif %}
          </div>
        </div>
      </div>
    </div>

    <div class="mt-3">
      <h2 class="h6 fw-bold mb-3">الثريدز</h2>

      {% for thread in threads %}
        {% include 'partials/thread_card.html' with thread=thread %}
      {% empty %}
        <div class="text-center text-secondary py-4">ما فيه ثريدز منشورة.</div>
      {% endfor %}
    </div>

  </div>
</div>
{% endblock %}
